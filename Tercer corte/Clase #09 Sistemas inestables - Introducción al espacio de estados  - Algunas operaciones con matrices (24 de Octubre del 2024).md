# Sistemas inestables - Introducci√≥n al espacio de estados - Algunas operaciones con matrices

Para esta clase, se dividide el temario en 2 partes:
- **Identificaci√≥n de la funci√≥n $G_m(s)$ y sintonizaci√≥n del controlador.** D√≥nde mediante el m√©todo de procesos integrantes, se obtiene la funci√≥n de transferencia en lazo abierto de un sistema que normalmente tiende a crecer indefinidamente. Esto ayuda a reducir esa tendencia a un valor fin√≠to.
- **Algunas operaciones en el Espacio de estados** En la conversi√≥n de funci√≥n de transferencia a espacio de estados, existen diversas operaciones que permiten obtener caracteristicas y relacionar variables. Tales como forma controlable, observable, etc.
  
## 1. **Identificaci√≥n de la funci√≥n $G_m(s)$ y sintonizaci√≥n del controlador.**
### 1.1 **Identificaci√≥n de la funci√≥n $G_m(s)$.**
Para lograr caracterizar una planta con comportamiento exponencial, se propone un m√©todo que permite obtener su comportamiento en lazo abierto con respecto a una entrada dada. Se conoce como **Caracterizaci√≥n de un proceso integrante**.

Entonces, a partir de la siguiente gr√°fica se determinan unos valores necesarios para armar el modelo del sistema:

![Respuesta din√°mica de un proceso integrante](https://github.com/user-attachments/assets/4bb5d28f-c472-4d36-b406-f9a03319c10f)

Figura 1. Respuesta din√°mica de un proceso integrante

Donde:
  - $O_1$ Es el estado bajo del sistema, muchas veces 0.
  - $O_2$ Es la magnitud de la se√±al en el tiempo $T_3$
    
  - $I_1$ Es el estado bajo del escal√≥n, muchas veces 0.
  - $I_2$ Es el estado alto del escal√≥n.
    
  - $T_1$ Es el tiempo donde el escal√≥n cambia de estado bajo a alto.
  - $T_2$ Es el tiempo donde se cruza una l√≠nea continua del estado de reposo y una linea diagonal de la pendiente de la se√±al.
  - $T_3$ Es el tiempo donde la amplitud de la se√±al del sitema y la se√±al de entrada es el mismo.

Con estos valores, es posible calcular la ganancia est√°tica del sistema o ganancia de integraci√≥n $K_m$, que no es m√°s que la pendiente de la curva.

$$K_m = \frac{O_2-O_1}{(I_2-I_1)(T_3-T_2)}$$

Tambi√©n, se puede obtener el tiempo muerto $T_m$

$$T_m = T_2 - T_1$$

Y as√≠, obtener la expresi√≥n $G_m(s)$ tambi√©n conocida como sistema de factor integrante m√°s tiempo muerto.

$$ùê∫_m(s) = \frac{K_m ¬∑ e^{-T_m ¬∑ s}}{s}$$

A partir de este punto, se puede identificar el controlador desea. El curso propone (Aparte de otros m√©todos como uso de rel√©s) el uso de un **controlador PI o PID**

### 1.2 **Sintonizaci√≥n del controlador.**

El sistema en lazo cerrado requiere de la obtenci√≥n de unos parametros de acuerdo al controlador escogido, tales como:
  - $K_c$ Ganancia proporcional.
  - $T_i$ Tiempo integral.
  - $T_d$ Tiempo derivativo.

![Sistema de control retroalimentado](https://github.com/user-attachments/assets/baf0b16a-919f-4fa0-838c-de682697cbb9)
Figura 2. Sistema de control retroalimentado

Estas magnitudes son obtenidas a partir de expresiones propuestas por cada autor y presentadas a continuaci√≥n

- **Controlador PI**

| M√©todo              | $K_c$                  | $T_i$     |
|---------------------|------------------------|-----------|
| Ziegler & Nichols   | $\frac{0.9}{K_mT_m}$   | $3.33T_m$ |
| Coon                | $\frac{1.0}{K_mT_m}$   | $0$       |
| Astr√∂m and H√§gglund | $\frac{0.63}{K_mT_m}$  | $3.2T_m$  |
| Hay                 | $\frac{0.42}{K_mT_m}$  | $5.8T_m$  |
| Skogestad           | $\frac{0.404}{K_mT_m}$ | $7T_m$    |

Tabla 1. Sinton√≠a del Controlador Proporcional - Integral

- **Controlador PID**

| M√©todo              | $K_c$                                           | $T_i$      | $T_d$                             |
|---------------------|-------------------------------------------------|------------|-----------------------------------|
| Ford                | $$\frac{1.48}{K_mT_m}$$                           | $2T_m$     | $0.37T_m$                         |
| Coon                | $$\frac{0.4}{K_mT_m}$$                            | $3.2T_m$   | $0.8T_m$                          |
| Astr√∂m and H√§gglund | $$\frac{0.94}{K_mT_m}$$                           | $2T_m$     | $0.5T_m$                          |
| Leonard             | $$\frac{0.74}{K_mT_m}$$                           | $12.2T_m$  | $0.41T_m$                         |
| Rotach              | $$\frac{1.21}{K_mT_m}$$                           | $1.6T_m$   | $0.48T_m$                         |
| Zou and Brigham     | $\frac{2}{K_m(ùúÜ + 0.5T_m}$  $0.5T_m ‚â§ ùúÜ ‚â§ 3T_m$ | $2ùúÜ + T_m$ | $\frac{ùúÜ + 0.25T_m}{2ùúÜ + T_m}T_m$ |

Tabla 2. Sinton√≠a del Controlador Proporcional - Integral - Derivativo

## 2. **Algunas operaciones en el Espacio de estados**

Es posible usar la representaci√≥n de estados como m√©todo para analizar y controlar un sistema, esto con el objetivo de relacionar el comportamiento de sistemas con multiples entradas y salidas. A continuaci√≥n se presentar√° en qu√© consiste y como formar estas matrices.

Se tiene una funci√≥n de transferencia discreta como:

$$G(z) = \frac{b_0z^n + b_1z^{n-1} +...+ b_{n-1}z + b_n}{z^n + a_1z^{n-1} +...+ a_{n-1}z + a_n}$$

A partir de sus coeficientes, se puede expresar en una matriz cuadrada del tama√±o del grado mayor de su polinomio

El tama√±o de la matriz debe ser cantidad de variables y cantidad de coeficientes. Es decir, s√≥lo puede ser 2x2 o superior para considerarse espacio, una matriz cuadrada.
### 2.1 **Forma can√≥nica Controlable**
üí°**Ejemplo 1:** 
Se tiene la funci√≥n:

$$\frac{Y(z)}{X(z)} = \frac{Az^3 + Bz^2 + Cz + D}{z^4 + Ez^3 + Fz^2 + Gz + H}$$

| $X_1(k+1)$ | ‚Äé‚Äé„Ö§|‚Äé„Ö§ 0„Ö§0„Ö§0„Ö§1„Ö§|| $X_1(k)$ |„Ö§| 0 |

| $X_2(k+2)$ | = |‚Äé„Ö§ 0„Ö§0„Ö§0„Ö§1„Ö§|| $X_2(k)$ | + | 0 |

| $X_3(k+3)$ | = |‚Äé„Ö§ 0„Ö§0„Ö§0„Ö§1„Ö§|| $X_3(k)$ | + | 0 | $u(k)$ 

| $X_4(k+4)$ | ‚Äé„Ö§|„Ö§-H -G„Ö§-F -E„Ö§|| $X_4(k)$ |„Ö§| 1 |


„Ö§„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§„Ö§„Ö§ „Ö§| $X_1(k)$ |

$Y(k) =$ |„Ö§D„Ö§C„Ö§B„Ö§A„Ö§|| $X_2(k)$ |

„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§„Ö§ „Ö§| $X_3(k)$ |

„Ö§„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§ „Ö§„Ö§| $X_4(k)$ |

### 2.2 **Forma can√≥nica Observable**

üí°**Ejemplo 2:** 
Se tiene la funci√≥n:

$$\frac{Y(z)}{X(z)} = \frac{Az^3 + Bz^2 + Cz + D}{z^4 + Ez^3 + Fz^2 + Gz + H}$$

| $X_1(k+1)$ | ‚Äé‚Äé„Ö§|‚Äé„Ö§ 0„Ö§0„Ö§0„Ö§-H„Ö§|| $X_1(k)$ |„Ö§| D |

| $X_2(k+2)$ | = |‚Äé„Ö§ 1„Ö§0„Ö§0„Ö§-G„Ö§|| $X_2(k)$ | + | C |

| $X_3(k+3)$ | = |‚Äé„Ö§ 0„Ö§1„Ö§0„Ö§-F„Ö§|| $X_3(k)$ | + | B | $u(k)$ 

| $X_4(k+4)$ | ‚Äé„Ö§|„Ö§ 0„Ö§0„Ö§1„Ö§-E„Ö§|| $X_4(k)$ |„Ö§| A |


„Ö§„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§„Ö§| $X_1(k)$ |

$Y(k) =$ |„Ö§ 0„Ö§0„Ö§0„Ö§1 „Ö§|| $X_2(k)$ |

„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§| $X_3(k)$ |

„Ö§„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§| $X_4(k)$ |

### 2.3 **Forma can√≥nica diagonal**

üí°**Ejemplo 3:** 
Se tienen los polos de la funci√≥n:

$$\frac{Y(z)}{X(z)} = \frac{Az^3 + Bz^2 + Cz + D}{(z+E)(z+F)(z+G)(z+H) = \frac{k_1}{(z+E)} + \frac{k_2}{(z+F)} + \frac{k_3}{(z+G)} + \frac{k_4}{(z+H)} +}$$

$$P_1 = -E;P_2 = -F;P_3 = -G;P_4 = -H;$$

| $X_1(k+1)$ | ‚Äé‚Äé„Ö§|‚Äé„Ö§ -E„Ö§0„Ö§0„Ö§0„Ö§|| $X_1(k)$ |„Ö§| 1 |

| $X_2(k+2)$ | = |‚Äé„Ö§ 0„Ö§-F„Ö§0„Ö§0„Ö§|| $X_2(k)$ | + | 1 |

| $X_3(k+3)$ | = |‚Äé„Ö§ 0„Ö§0„Ö§-G„Ö§0„Ö§|| $X_3(k)$ | + | 1 | $u(k)$ 

| $X_4(k+4)$ | ‚Äé„Ö§|„Ö§ 0„Ö§0„Ö§0„Ö§-H„Ö§|| $X_4(k)$ |„Ö§| 1 |



„Ö§„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§„Ö§„Ö§ „Ö§| $X_1(k)$ |

$Y(k) =$ |„Ö§ $k_1„Ö§k_2„Ö§k_3„Ö§k_4$ „Ö§|| $X_2(k)$ |

„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§„Ö§ „Ö§| $X_3(k)$ |

„Ö§„Ö§ „Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§ „Ö§ „Ö§| $X_4(k)$ |


## 10. Conclusiones
A partir de esta informaci√≥n, es posible empezar a dise√±ar un sistema de control. Muchos de estos m√©todos son algebr√°icos y requieren de cierta destreza junto con claridad para resolverlos. Contando con un paso a paso, es posible resolver muchos problemas.

El m√©todo de caracterizaci√≥n de una exponencia fue √∫til para obtener la curva de reacci√≥n de la planta trabajada en el proyecto final.

## 11. Referencias

[1] "Caracterizaci√≥n de sistemas integrantes" Curso Control Digital

[2] "Operaciones con espacio de estados" Curso Control Digital

[3] "Formas Canonicas de un Espacio de Estado" The Kelvin Talk Show Youtube https://www.youtube.com/watch?v=TuXAeY2V9ZA
